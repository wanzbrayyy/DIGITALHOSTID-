<%- include('../partials/header', { title: title || 'Manajemen Domain' }) %>

<style>
    :root {
        --status-active-bg: #e7f7f2; --status-active-fg: #0d8a59;
        --status-suspended-bg: #feedee; --status-suspended-fg: #ef4444;
        --status-pending-bg: #eef3ff; --status-pending-fg: #4a00e0;
    }

    .page-header { margin-bottom: 2.5rem; /* ... */ }
    
    .domains-card {
        background-color: white; border-radius: var(--border-radius-lg);
        padding: 2rem; box-shadow: var(--shadow-lg);
    }

    /* Domains Table */
    .domains-table { width: 100%; border-collapse: collapse; }
    .domains-table th, .domains-table td {
        padding: 1rem 1.5rem; text-align: left;
        border-bottom: 1px solid var(--color-border);
        vertical-align: middle;
    }
    .domains-table th { font-weight: 600; font-size: 0.9rem; color: var(--color-text-muted); }
    .domains-table tr:last-child td { border-bottom: none; }
    
    .status-badge {
        padding: 6px 12px; border-radius: 50px;
        font-size: 0.8rem; font-weight: 600; text-transform: capitalize;
    }
    .status-active { background-color: var(--status-active-bg); color: var(--status-active-fg); }
    .status-suspended { background-color: var(--status-suspended-bg); color: var(--status-suspended-fg); }
    .status-pending { background-color: var(--status-pending-bg); color: var(--status-pending-fg); }
    
    /* Action Form in Table */
    .action-form { display: flex; align-items: center; gap: 10px; }
    .action-form .form-control-sm {
        padding: 8px 12px; font-size: 0.9rem; min-width: 150px;
        border-radius: var(--border-radius-md); background-color: var(--color-bg-light);
        border: 1px solid var(--color-border);
    }
</style>

<div class="container" style="padding-top: 3rem; padding-bottom: 3rem;">
    <div class="page-header">
        <h1><i class="fas fa-globe-americas"></i> Manajemen Domain</h1>
        <p>Daftar semua domain yang terdaftar melalui sistem. Anda dapat melakukan tindakan seperti men-suspend domain dari sini.</p>
    </div>

    <div class="domains-card">
        <div class="table-wrapper">
            <table class="domains-table">
                <thead>
                    <tr>
                        <th>Nama Domain</th>
                        <th>ID Pelanggan</th>
                        <th>Status</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (domains && domains.length > 0) { %>
                        <% domains.forEach(domain => { %>
                            <% const status = (domain.status_desc || '').toLowerCase().replace(/\s+/g, '-'); %>
                            <tr>
                                <td style="font-weight: 600;"><%= domain.name || 'N/A' %></td>
                                <td><%= domain.customer_id || 'N/A' %></td>
                                <td><span class="status-badge status-<%= status %>"><%= domain.status_desc || 'Tidak Diketahui' %></span></td>
                                <td>
                                    <% if (status === 'active') { %>
                                        <form class="action-form" action="/admin/domains/<%= domain.id %>/suspend" method="POST" onsubmit="return confirm('Yakin ingin men-suspend domain ini?');">
                                            <input type="text" name="reason" placeholder="Alasan Suspend" class="form-control-sm" required>
                                            <button type="submit" class="btn btn-danger btn-sm">Suspend</button>
                                        </form>
                                    <% } else if (status === 'suspended') { %>
                                        <form action="/admin/domains/<%= domain.id %>/unsuspend" method="POST" onsubmit="return confirm('Yakin ingin mengaktifkan kembali domain ini?');">
                                            <button type="submit" class="btn btn-primary btn-sm">Unsuspend</button>
                                        </form>
                                    <% } else { %>
                                        <span style="color: var(--color-text-muted);">(Tidak ada aksi)</span>
                                    <% } %>
                                </td>
                            </tr>
                        <% }) %>
                    <% } else { %>
                        <tr>
                            <td colspan="4" style="padding: 40px; text-align: center;">Tidak ada domain yang ditemukan.</td>
                        </tr>
                    <% } %>
                </tbody>
            </table>
        </div>
    </div>
</div>

<%- include('../partials/footer') %>