<%- include('partials/header') %>

<style>
    .hero-section {
        position: relative;
        background-image: url('https://files.catbox.moe/sepzlr.png?q=80&w=2069&auto=format&fit=crop');
        background-size: cover;
        background-position: center;
        color: var(--nexus-text-light);
        padding: 100px 0;
        text-align: center;
        z-index: 1;
    }
    .hero-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, rgba(142, 68, 173, 0.8), rgba(31, 29, 43, 0.9));
        z-index: -1;
    }
   .promo-banner { background: linear-gradient(45deg, var(--nexus-primary), var(--nexus-primary-dark)); color: white; text-align: center; padding: 2rem; border-radius: var(--nexus-radius); margin: 4rem auto; box-shadow: 0 10px 30px rgba(130, 170, 255, 0.3); }
    #domain-search-form { display: flex; max-width: 700px; margin: 0 auto; box-shadow: var(--nexus-shadow); border-radius: 50px; }
    #domain-input { flex-grow: 1; padding: 18px 25px; border: 2px solid transparent; font-size: 1rem; border-radius: 50px 0 0 50px; outline: none; }
    #domain-search-button { padding: 18px 35px; border-radius: 0 50px 50px 0; background: var(--nexus-secondary); color: white; border: none; cursor: pointer; font-size: 1rem; font-weight: 600; }
    #domain-results { margin-top: 35px; max-width: 700px; margin-left: auto; margin-right: auto; }
    .suggestion-item { background: white; display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; border-radius: var(--nexus-radius); box-shadow: var(--nexus-shadow); margin-bottom: 12px; }
    
    .domain-pricing-homepage { padding: 60px 0; }
    .domain-pricing-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 1rem; }
    .domain-price-card { text-align: center; padding: 1.5rem 1rem; border-radius: var(--nexus-radius); border: 1px solid #eee; transition: all 0.3s ease; }
    .domain-price-card:hover { transform: translateY(-5px); box-shadow: var(--nexus-shadow); border-color: var(--nexus-primary); }
    .domain-price-card .tld { font-size: 1.5rem; font-weight: 700; color: var(--nexus-text-dark); }
    .domain-price-card .price { font-size: 1.2rem; font-weight: 600; color: var(--nexus-primary-dark); margin: 0.5rem 0; }
    .domain-price-card .original-price { font-size: 0.9rem; color: var(--nexus-text-gray); text-decoration: line-through; }
    .domain-price-card.promo { border-left: 4px solid var(--nexus-danger); }
</style>

<main>
    <section class="hero-section">
        <div class="container">
            <h1>Semua yang Anda Butuhkan untuk Sukses Online</h1>
            <p>Mulai dari domain, hosting, hingga alat canggih untuk mengembangkan bisnis Anda.</p>
            <a href="#pricing" class="btn btn-primary" style="margin-top: 1.5rem;">Lihat Paket Sekarang</a>
        </div>
    </section>

    <div class="container">
        <% if (typeof promo !== 'undefined' && promo && promo.isActive) { %>
            <section class="promo-banner">
                <h3><%= promo.title %></h3><p><%= promo.message %></p>
                <% if (promo.link) { %><a href="<%= promo.link %>" class="btn" style="margin-top: 1rem; background: white; color: var(--nexus-primary-dark);">Lihat Selengkapnya</a><% } %>
            </section>
        <% } %>
    </div>

    <section id="domain-search" class="domain-search-section">
        <div class="container">
            <h2>Wujudkan Ide Anda dengan Domain Sempurna</h2>
            <form id="domain-search-form">
                <input type="text" id="domain-input" placeholder="contoh: wanzofc.site" required>
                <button type="submit" id="domain-search-button"><i class="fas fa-search"></i> Cari</button>
            </form>
            <div id="domain-results"></div>
        </div>
    </section>

    <section class="domain-pricing-homepage">
        <div class="container">
            <h2 style="text-align: center; margin-bottom: 2rem;">Promo Domain Terpopuler</h2>
            <div class="domain-pricing-grid">
                <% if (domainPrices && domainPrices.length > 0) { %>
                    <% domainPrices.forEach(item => { %>
                        <div class="domain-price-card <%= item.hasPromo ? 'promo' : '' %>">
                            <div class="tld"><%= item.extension %></div>
                            <div class="price">Rp <%= item.price.toLocaleString('id-ID') %></div>
                            <% if (item.price < item.originalPrice) { %>
                                <div class="original-price">Rp <%= item.originalPrice.toLocaleString('id-ID') %></div>
                            <% } %>
                        </div>
                    <% }) %>
                <% } %>
            </div>
            <div style="text-align: center; margin-top: 2rem;">
                <a href="/domain-pricing" class="btn btn-secondary">Lihat Semua Harga Domain</a>
            </div>
        </div>
    </section>

    <section id="pricing" class="pricing-section">
        <div class="container">
            <h2>Pilih Paket Terbaik Anda</h2>
            <div class="pricing-slider-container">
                <div class="pricing-grid" id="pricing-grid">
                    <% if (products && products.length > 0) { %>
                        <% products.forEach(product => { %>
                            <div class="pricing-card">
                                <div style="font-size: 3rem; text-align: center; color: var(--nexus-secondary); margin-bottom: 1rem;"><i class="<%= product.icon %>"></i></div>
                                <h3><%= product.name %></h3>
                                <p><%= product.description %></p>
                                <div><sup>Rp</sup><%= product.price.toLocaleString('id-ID') %><span><%= product.price_unit %></span></div>
                                <ul style="margin-top: 1rem;">
                                    <% product.features.forEach(feature => { %>
                                        <li><i class="fas fa-check-circle" style="color: var(--nexus-success);"></i> <%= feature %></li>
                                    <% }) %>
                                </ul>
                                <form action="/add-to-cart" method="POST" style="margin-top: auto;">
                                    <input type="hidden" name="type" value="product">
                                    <input type="hidden" name="plan" value="<%= product.name %>">
                                    <input type="hidden" name="price" value="<%= product.price %>">
                                    <button type="submit" class="btn btn-primary" style="width: 100%;">Pilih <%= product.name %></button>
                                </form>
                            </div>
                        <% }) %>
                    <% } %>
                </div>
            </div>
        </div>
    </section>
</main>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const domainForm = document.getElementById('domain-search-form');
        const domainInput = document.getElementById('domain-input');
        const domainResults = document.getElementById('domain-results');
        
        domainForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const keyword = domainInput.value.trim();
            if (!keyword) return;
            domainResults.innerHTML = '<div class="spinner"></div>';
            try {
                const response = await fetch('/check-domain', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ keyword }) });
                const results = await response.json();
                let resultsHTML = '<ul style="list-style:none; padding:0;">';
                results.forEach(result => {
                    let statusHTML = '';
                    if (result.status === 'available') {
                        statusHTML = `<div><span class="status-available">TERSEDIA</span> <a href="/order-domain?domain=${result.name}" class="btn btn-secondary btn-sm">Daftar</a></div>`;
                    } else if (result.status === 'taken') {
                        statusHTML = `<span class="status-taken">Sudah Diambil</span>`;
                    } else {
                        statusHTML = `<span class="status-taken">Gagal memeriksa</span>`;
                    }
                    resultsHTML += `<li class="suggestion-item"><span>${result.name}</span> ${statusHTML}</li>`;
                });
                resultsHTML += '</ul>';
                domainResults.innerHTML = resultsHTML;
            } catch (error) {
                domainResults.innerHTML = `<div style="text-align: center; color: var(--nexus-danger);">Terjadi kesalahan koneksi.</div>`;
            }
        });
    });
</script>
<%- include('partials/footer') %>