<%- include('partials/header') %>

<style>
    .promo-banner { background: var(--nexus-primary-dark); color: white; text-align: center; padding: 1.5rem; margin-top: -30px; margin-bottom: 30px; border-radius: var(--nexus-radius); }
    .hero-section { background: linear-gradient(135deg, var(--nexus-secondary) 0%, var(--nexus-background-dark) 100%); color: var(--nexus-text-light); padding: 80px 0; text-align: center; }
    .domain-search-section { padding: 60px 0; }
    #domain-search-form { display: flex; max-width: 700px; margin: 0 auto; box-shadow: var(--nexus-shadow); border-radius: 50px; }
    #domain-input { flex-grow: 1; padding: 18px 25px; border: 2px solid transparent; font-size: 1rem; border-radius: 50px 0 0 50px; outline: none; }
    #domain-search-button { padding: 18px 35px; border-radius: 0 50px 50px 0; background: var(--nexus-secondary); color: white; border: none; cursor: pointer; font-size: 1rem; font-weight: 600; }
    #domain-results { margin-top: 35px; max-width: 700px; margin-left: auto; margin-right: auto; }
    .suggestion-item { background: white; display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; border-radius: var(--nexus-radius); box-shadow: var(--nexus-shadow); margin-bottom: 12px; }
    .status-available { color: var(--nexus-success); font-weight: 600; } .status-taken { color: var(--nexus-text-gray); }
    .pricing-section { padding: 60px 0; overflow: hidden; }
    .pricing-grid { display: flex; overflow-x: auto; scroll-snap-type: x mandatory; padding: 1rem 1rem 2rem 1rem; margin: 0 -1rem; } .pricing-grid::-webkit-scrollbar { display: none; }
    .pricing-card { scroll-snap-align: center; flex: 0 0 280px; margin: 0 15px; background: white; border-radius: 16px; padding: 30px; box-shadow: var(--nexus-shadow); text-align: left; transition: all 0.3s ease; display: flex; flex-direction: column; }
    .pricing-card:hover { transform: translateY(-10px); box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15); }
    .pricing-card div:first-of-type { font-size: 2.5rem; font-weight: 700; margin-bottom: 1.5rem; } .pricing-card ul { list-style: none; padding: 0; } .pricing-card ul li { margin-bottom: 0.5rem; }
</style>

<main>
    <% if (typeof promo !== 'undefined' && promo && promo.isActive) { %>
    <div class="container">
        <section class="promo-banner">
            <h3 style="margin-bottom: 0.5rem;"><%= promo.title %></h3>
            <p><%= promo.message %></p>
            <% if (promo.link) { %><a href="<%= promo.link %>" class="btn btn-secondary" style="margin-top: 1rem; background: white; color: var(--nexus-secondary-dark);">Lihat Selengkapnya</a><% } %>
        </section>
    </div>
    <% } %>

    <section class="hero-section">
        <div class="container">
            <h1>Semua yang Anda Butuhkan untuk Sukses Online</h1>
            <p>Mulai dari domain, hosting, hingga alat canggih untuk mengembangkan bisnis Anda.</p>
            <a href="#pricing" class="btn btn-primary">Lihat Paket Sekarang</a>
        </div>
    </section>

    <section id="domain-search" class="domain-search-section">
        <div class="container">
            <h2>Wujudkan Ide Anda dengan Domain Sempurna</h2>
            <form id="domain-search-form">
                <input type="text" id="domain-input" placeholder="contoh: wanzofc.site" required>
                <button type="submit" id="domain-search-button"><i class="fas fa-search"></i> Cari</button>
            </form>
            <div id="domain-results"></div>
        </div>
    </section>

    <section id="pricing" class="pricing-section">
        <div class="container">
            <h2>Pilih Paket Terbaik Anda</h2>
            <div class="pricing-slider-container">
                <div class="pricing-grid" id="pricing-grid">
                    <% if (products && products.length > 0) { %>
                        <% products.forEach(product => { %>
                            <div class="pricing-card">
                                <div style="font-size: 3rem; text-align: center; color: var(--nexus-secondary); margin-bottom: 1rem;"><i class="<%= product.icon %>"></i></div>
                                <h3><%= product.name %></h3>
                                <p><%= product.description %></p>
                                <div><sup>Rp</sup><%= product.price.toLocaleString('id-ID') %><span><%= product.price_unit %></span></div>
                                <ul style="margin-top: 1rem;">
                                    <% product.features.forEach(feature => { %>
                                        <li><i class="fas fa-check-circle" style="color: var(--nexus-success);"></i> <%= feature %></li>
                                    <% }) %>
                                </ul>
                                <form action="/add-to-cart" method="POST" style="margin-top: auto;">
                                    <input type="hidden" name="type" value="product">
                                    <input type="hidden" name="plan" value="<%= product.name %>">
                                    <input type="hidden" name="price" value="<%= product.price %>">
                                    <button type="submit" class="btn btn-primary" style="width: 100%;">Pilih <%= product.name %></button>
                                </form>
                            </div>
                        <% }) %>
                    <% } %>
                </div>
            </div>
        </div>
    </section>
</main>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const domainForm = document.getElementById('domain-search-form');
        const domainInput = document.getElementById('domain-input');
        const domainResults = document.getElementById('domain-results');
        
        domainForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const keyword = domainInput.value.trim();
            if (!keyword) return;
            domainResults.innerHTML = '<div class="spinner"></div>';
            try {
                const response = await fetch('/check-domain', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ keyword }) });
                const results = await response.json();
                let resultsHTML = '<ul style="list-style:none; padding:0;">';
                results.forEach(result => {
                    let statusHTML = '';
                    if (result.status === 'available') {
                        statusHTML = `<div><span class="status-available">TERSEDIA</span> <a href="/order-domain?domain=${result.name}" class="btn btn-secondary btn-sm">Daftar</a></div>`;
                    } else if (result.status === 'taken') {
                        statusHTML = `<span class="status-taken">Sudah Diambil</span>`;
                    } else {
                        statusHTML = `<span class="status-taken">Gagal memeriksa</span>`;
                    }
                    resultsHTML += `<li class="suggestion-item"><span>${result.name}</span> ${statusHTML}</li>`;
                });
                resultsHTML += '</ul>';
                domainResults.innerHTML = resultsHTML;
            } catch (error) {
                domainResults.innerHTML = `<div style="text-align: center; color: var(--nexus-danger);">Terjadi kesalahan koneksi.</div>`;
            }
        });
    });
</script>
<%- include('partials/footer') %>